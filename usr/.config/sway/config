# --- Variables ---
set $mainMod Mod4
set $terminal ghostty
set $fileManager nautilus
set $menu fuzzel

# --- Monitors ---
# DP-1: 4K, scale 2.0 / eDP-1: FHD, scale 1.0 (positioned below DP-1)
output DP-1 resolution 3840x2160 pos 0 0 scale 2.0
output eDP-1 resolution 1920x1200 pos 0 1080 scale 1.0

# --- Input ---
input * {
    xkb_layout "us"
    xkb_options "ctrl:swap_lalt_lctl,ctrl:swap_ralt_rctl"
    repeat_delay 230
    repeat_rate 42
    natural_scroll enabled
}

input "elan06c7:00-04f3:3193-touchpad" {
    natural_scroll enabled
    pointer_accel 0.5
}

# --- Keybindings ---
bindsym $mainMod+q kill
bindsym $mainMod+t exec $terminal
bindsym $mainMod+m exec swaynag -t warning -m 'Exit Sway?' -b 'Yes' 'swaymsg exit'
bindsym $mainMod+e exec $fileManager
bindsym $mainMod+v floating toggle
bindsym $mainMod+d exec $menu
bindsym $mainMod+f fullscreen toggle
bindsym $mainMod+j layout toggle split

# Focus / Move
bindsym $mainMod+left focus left
bindsym $mainMod+right focus right
bindsym $mainMod+up focus up
bindsym $mainMod+down focus down

# Move containers
bindsym $mainMod+Shift+left move left
bindsym $mainMod+Shift+right move right
bindsym $mainMod+Shift+up move up
bindsym $mainMod+Shift+down move down

# --- Workspaces (1-10) ---
bindsym $mainMod+1 workspace number 1
bindsym $mainMod+2 workspace number 2
bindsym $mainMod+3 workspace number 3
bindsym $mainMod+4 workspace number 4
bindsym $mainMod+5 workspace number 5
bindsym $mainMod+6 workspace number 6
bindsym $mainMod+7 workspace number 7
bindsym $mainMod+8 workspace number 8
bindsym $mainMod+9 workspace number 9
bindsym $mainMod+0 workspace number 10

# Move to workspace (1-10)
bindsym $mainMod+Shift+1 move container to workspace number 1
bindsym $mainMod+Shift+2 move container to workspace number 2
bindsym $mainMod+Shift+3 move container to workspace number 3
bindsym $mainMod+Shift+4 move container to workspace number 4
bindsym $mainMod+Shift+5 move container to workspace number 5
bindsym $mainMod+Shift+6 move container to workspace number 6
bindsym $mainMod+Shift+7 move container to workspace number 7
bindsym $mainMod+Shift+8 move container to workspace number 8
bindsym $mainMod+Shift+9 move container to workspace number 9
bindsym $mainMod+Shift+0 move container to workspace number 10

# Special Workspace (Scratchpad)
# Swayでは"scratchpad show"で非表示・表示をトグルします
bindsym $mainMod+s scratchpad show
bindsym $mainMod+Shift+s move scratchpad

# Utils
bindsym $mainMod+l exec hyprlock
bindsym $mainMod+w exec ~/.config/sway/random-wallpaper.sh
bindsym Control+Shift+s exec grimshot copy area

# Media keys
bindsym XF86AudioRaiseVolume exec volumectl -u up
bindsym XF86AudioLowerVolume exec volumectl -u down
bindsym XF86AudioMute exec volumectl toggle-mute
bindsym XF86MonBrightnessUp exec lightctl up
bindsym XF86MonBrightnessDown exec lightctl down

# --- Autostart ---
exec {
    # ポータルと環境変数の更新（画面共有などに必要）
    dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway
    
    fcitx5 -d
    hypridle
    swaync
    avizo-service
    wl-paste --type text --watch cliphist store
    wl-paste --type image --watch cliphist store
    
    # WaybarをSway用設定で起動
    waybar -c ~/.config/waybar/config_sway.jsonc -s ~/.config/waybar/style.css
    ~/.config/sway/random-wallpaper.sh
}

# ポータルの明示的な起動（Hyprlandから移行する場合に重要）
exec /usr/lib/xdg-desktop-portal-sway -r
exec /usr/lib/xdg-desktop-portal-gtk -r

# --- Appearance ---
default_border pixel 1
gaps inner 0
gaps outer 0
smart_gaps on

# ウィンドウのタイトルバーを非表示にする（Waybarがあるため）
default_floating_border pixel 1
for_window [class=".*"] border pixel 1
